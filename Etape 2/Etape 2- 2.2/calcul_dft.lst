


ARM Macro Assembler    Page 1 


    1 00000000                 thumb
    2 00000000         
    3 00000000                 extern           TabSin
    4 00000000                 extern           TabCos
    5 00000000                 extern           TabSig2
    6 00000000         
    7 00000000                 area             moncode, code, readonly
    8 00000000                 export           calcul_Reel
    9 00000000                 export           calcul_Imaginaire
   10 00000000                 export           M2
   11 00000000         
   12 00000000         M2      proc
   13 00000000         ; r0 contient k
   14 00000000         ; r1 contient @ de signal
   15 00000000         ; r2 contient la partie Imaginaire 
   16 00000000         ; r3 contient la partie Réel 
   17 00000000         
   18 00000000 E92D 4783       push             {LR, r0, r1,r7-r10}
   19 00000004 F7FF FFFE       bl               calcul_Reel
   20 00000008 4603            mov              r3, r0      ; Re dans r1
   21 0000000A BC03            pop              {r0,r1}
   22 0000000C B408            push             {r3}
   23 0000000E F7FF FFFE       bl               calcul_Imaginaire
   24 00000012 4602            mov              r2, r0      ; Im dans r2
   25 00000014 BC08            pop{r3}
   26 00000016         
   27 00000016         
   28 00000016 FB83 7803       smull            r7, r8,r3,r3 ; Re²
   29 0000001A FB82 9A02       smull            r9,r10,r2,r2 ; Im²
   30 0000001E 44D0            add              r8,r10      ; Re²+Im²
   31 00000020 4640            mov              r0,r8
   32 00000022 E8BD 0780       pop              {r7-r10}
   33 00000026 F85D EB04       pop              {LR}
   34 0000002A         
   35 0000002A         
   36 0000002A 4770            BX               LR
   37 0000002C                 endp
   38 0000002C         
   39 0000002C         
   40 0000002C         ; Pour ces fonctions, on va utiliser les registres compr
                       is entre R4 et R11 
   41 0000002C         ; En effet, ces registres vont être utilisés comme stock
                       age temporaire à condition de les push et pop avant le r
                       etour 
   42 0000002C 0000003F 
                       masque  equ              0x3F        ; pour faire un mod
                                                            ulo 64
   43 0000002C         
   44 0000002C         ; ****************** Explications***********************
                       ********************************
   45 0000002C         
   46 0000002C         ;  r0 contient k
   47 0000002C         ;   r1 contient @Signal 
   48 0000002C         ;   r2 cotient TabCos ou TabSin
   49 0000002C         ;   r3 contient x(i) échantillon signal
   50 0000002C         ;   r4 contient cos(i*k) ou sin(i*k)
   51 0000002C         ;   r5 contient i*k
   52 0000002C         ;   r6 la somme des x(i)*cos(i*k) ou x(i)*sin(i*k)
   53 0000002C         ;   r7 contient x(i)*cos(i*k) ou x(i) * sin(i*k)



ARM Macro Assembler    Page 2 


   54 0000002C         ;   r12 contient i
   55 0000002C         
   56 0000002C         calcul_Imaginaire
                               proc
   57 0000002C B4F0            push             {r4-r7}
   58 0000002E F04F 0C00       mov              r12, #0x00
   59 00000032 4A0D            ldr              r2, =TabSin ;          on met l
                                                            '@ de TabSin
   60 00000034 E004            b                loop
   61 00000036                 endp
   62 00000036         
   63 00000036         calcul_Reel
                               proc
   64 00000036 B4F0            push             {r4-r7}
   65 00000038 F04F 0C00       mov              r12, #0x00
   66 0000003C 4A0B            ldr              r2, =TabCos ;          on met l
                                                            '@ de TabCos
   67 0000003E E7FF            b                loop
   68 00000040         
   69 00000040         loop
   70 00000040         
   71 00000040         ; A partir de la sauvegarde des adresses dans r2, on va 
                       pouvoir calculer la partie réelle  et imaginaire
   72 00000040 FB0C F500       mul              r5,r12,r0   ;          i * k 
   73 00000044 F005 053F       and              r5, #masque ;          i * k mo
                                                            d 64 
   74 00000048         
   75 00000048 F932 4015       ldrsh            r4, [r2, r5, lsl #0x01] ;      
                                                            cos(i*k) | sin(i*k)
                                                             
   76 0000004C         
   77 0000004C F931 301C       ldrsh            r3, [r1,r12, lsl #0x01] 
                                                            ;      x(i)
   78 00000050         
   79 00000050 FB03 F704       mul              r7,r3,r4    ;           x(i)*co
                                                            s(i*k)| x(i)*sin(i*
                                                            k)
   80 00000054         
   81 00000054         
   82 00000054         
   83 00000054 443E            add              r6,r7       ;           somme d
                                                            es x(i)*cos(ik) | x
                                                            (i)*sin(ik)
   84 00000056         
   85 00000056 F10C 0C01       add              r12, #0x01  ;         i=0 
   86 0000005A F1BC 0F40       cmp              r12,#64     ;                  
                                                                              à
                                                             i=64
   87 0000005E D1EF            bne              loop
   88 00000060         
   89 00000060         ;             sinon on quitte la boucle  
   90 00000060 4630            mov              r0,r6
   91 00000062 E7FF            b                fin
   92 00000064         
   93 00000064         
   94 00000064         
   95 00000064         fin
   96 00000064 BCF0            pop              {r4-r7}
   97 00000066 4770            bx               lr



ARM Macro Assembler    Page 3 


   98 00000068                 endp
   99 00000068                 end
              00000000 
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interw
ork --depend=.\obj\calcul_dft.d -o.\obj\calcul_dft.o -I.\RTE\_Simu -IC:\Users\y
acin\AppData\Local\Arm\Packs\ARM\CMSIS\5.6.0\CMSIS\Core\Include -IC:\Users\yaci
n\AppData\Local\Arm\Packs\Keil\STM32F1xx_DFP\2.3.0\Device\Include --predefine="
__EVAL SETA 1" --predefine="__MICROLIB SETA 1" --predefine="__UVISION_VERSION S
ETA 529" --predefine="_RTE_ SETA 1" --predefine="STM32F10X_MD SETA 1" --list=ca
lcul_dft.lst calcul_dft.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

M2 00000000

Symbol: M2
   Definitions
      At line 12 in file calcul_dft.s
   Uses
      At line 10 in file calcul_dft.s
Comment: M2 used once
calcul_Imaginaire 0000002C

Symbol: calcul_Imaginaire
   Definitions
      At line 56 in file calcul_dft.s
   Uses
      At line 9 in file calcul_dft.s
      At line 23 in file calcul_dft.s

calcul_Reel 00000036

Symbol: calcul_Reel
   Definitions
      At line 63 in file calcul_dft.s
   Uses
      At line 8 in file calcul_dft.s
      At line 19 in file calcul_dft.s

fin 00000064

Symbol: fin
   Definitions
      At line 95 in file calcul_dft.s
   Uses
      At line 91 in file calcul_dft.s
Comment: fin used once
loop 00000040

Symbol: loop
   Definitions
      At line 69 in file calcul_dft.s
   Uses
      At line 60 in file calcul_dft.s
      At line 67 in file calcul_dft.s
      At line 87 in file calcul_dft.s

moncode 00000000

Symbol: moncode
   Definitions
      At line 7 in file calcul_dft.s
   Uses
      None
Comment: moncode unused
6 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

masque 0000003F

Symbol: masque
   Definitions
      At line 42 in file calcul_dft.s
   Uses
      At line 73 in file calcul_dft.s
Comment: masque used once
1 symbol



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

TabCos 00000000

Symbol: TabCos
   Definitions
      At line 4 in file calcul_dft.s
   Uses
      At line 66 in file calcul_dft.s
Comment: TabCos used once
TabSig2 00000000

Symbol: TabSig2
   Definitions
      At line 5 in file calcul_dft.s
   Uses
      None
Comment: TabSig2 unused
TabSin 00000000

Symbol: TabSin
   Definitions
      At line 3 in file calcul_dft.s
   Uses
      At line 59 in file calcul_dft.s
Comment: TabSin used once
3 symbols
347 symbols in table
